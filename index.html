<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>editor</title>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
        <div class="textarea" id="txt-editor">
            <textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
            <div class="ace_layer ace_text-layer">
               
            </div>
            <div class="ace_layer ace_cursor-layer">
                <div class="ace_cursor"></div>
            </div>
        </div>
        <div class="des">
        <p>您好，非常高兴收到贵公司的邮件面试题，我大概看了一下题目，心里做到有底，想着怎么实现，但当我真的按照用可编辑div 去判断它的输入，然后在拼接重组它的字符串的时候，它的光标位置始终不对，最先也想到用原生Javascript的范围去截取可编辑div以前的字符串和我正在输入的字符串进行拼接，但我发现也不行，这两技术都不能实现文本编辑器高亮特殊字符的效果。</p>
        <p>后面看了附录资料的ace编辑器大概理解了它的实现原理，就是用一个小的不可见的可输入的textarea编辑框执行可输入任务、用一个文本div去展现 文本框的输入、一个根据文本框获得、失去焦点显隐的作动画的模拟光标元素做光标来模拟可编辑框的。</p>
        <p>实现这个编辑框的难点对我来说是获得每个字符的宽度，从而计算准确的计算光标，从而在该位置进行元素的拼接、分离、创建。我去根据每个字符宽度实现span宽度的时候浏览器卡死了，所以我就大体的根据span的总宽度除以span字符串的宽度得到单个字符的平均宽度的，所以当我根据光标的left值与行中每个span的宽度累积起来去确定所在行光标所在的span和在span中的charaterPos位置的时候，会有一点偏移。正是因为偏移的存在才导致了光标的位置有时在字符之上，而不是在两个字符之间;正是因为这种偏移导致的光标位置不确定有时候插入元素可能存在该插入元素之后，位置有一点点偏移。</p>
        <p>虽然这个编辑器有一点点bug，但是还是实现了它该有的功能。
            <ul>
                <li>1.能够标志出'('、')'、'and'、'or'、'not'、值、条件运算符、数字类型字段、字符串类型字段、不在数据库中的字段</li>
                <li>2.可以通过click切换光标位置、随意插入字符、Backspace、delete删除字符、enter键跳到下一行、向上、向下、向左、向右移动光标。</li>
            </ul>
            希望你能操作它还算顺利，是你想要的编辑器。
        </p>
        <p>附注:因为工作的原因，我只能每天下班和周末的时间回去做这个，所以从上周星期二接到通知到现在也有9天了，有点晚了，希望您见谅！</p>
      </div>
        <script src="editor.js">  </script>
    </body>
</html>